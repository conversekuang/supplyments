



磁面数 = 磁盘数 * 2

存储容量 ＝ 磁头数(磁面数) × 磁道(柱面)数 × 每道扇区数 × 每扇区字节数



##### 磁盘的记录方式有两种：

1.旧式——非分区记录方式（不同磁道扇区数相同）

​	每个磁道上的扇区是一样的。导致密度是不一样的。

​	缺点：浪费空间



2.新式——分区记录方式（不同磁道扇区数不同）

​	在密度一样的情况下，磁道长的容纳的扇区多。

​	

##### 磁盘写入顺序

如果有一块空硬盘，写入一个文件，是不是先写满同一个磁道的所有扇区，然后再换一个磁道写入？

​	而且写入的方式是从外到内，先写满最外的磁道，接着再写里面的磁道

​	这也是为什么机械硬盘在测试处理大量数据的吞吐率不断下降的原因，因为处理到内圈的数据时要多次移动移动机械臂，产生更多的延时



根据不同的技术，采用的方式不一样。

https://www.zhihu.com/question/20537787





##### 扇区、块/簇、page的关系

操作系统经常与内存和硬盘这两种存储设备进行通信，类似于“块”的概念，都需要一种虚拟的基本单位。所以，与内存操作，是虚拟一个页的概念来作为最小单位。与硬盘打交道，就是以块为最小单位。

1. 扇区： 硬盘的最小读写单元
2. 块/簇： 是操作系统针对硬盘读写的最小单元
3. page： 是内存与操作系统之间操作的最小单元。

扇区 <= 块/簇 <= page

https://ksou.cc/w/dhr/170536847.html





即一次访盘请求（读/写）完成过程由三个动作组成：
       1）寻道（时间）：磁头移动定位到指定磁道 
       2）旋转延迟（时间）：等待指定扇区从磁头下旋转经过 
       3）数据传输（时间）：数据在磁盘与内存之间的实际传输

https://blog.csdn.net/sswltt/article/details/103249910



##### 随机IO 与顺序IO

**连续 I/O** ：指的是本次 I/O 给出的初始扇区地址和上一次 I/O 的结束扇区地址是完全连续或者相隔不多的。反之，如果相差很大，则算作一次随机 I/O。

而发生随机I/O可能是因为磁盘碎片导致磁盘空间不连续，或者当前block空间小于文件大小导致的。

连续 I/O 比随机 I/O 效率高的原因是：在做连续 I/O 的时候，**磁头几乎不用换道，或者换道的时间很短**；而对于随机 I/O，如果这个 I/O 很多的话，会导致磁头不停地换道，造成效率的极大降低。



差距在于寻到时间的差异。



性能分析：IO使用率比较高的情况下，如果依旧是每次写4K左右，那就是随机写多；如果是每次写67K左右，那就是顺序写多。

https://cloud.tencent.com/developer/article/1598469



---

这方面我自己也不是太清楚操作系统底层的磁盘读写原理，根据查的资料和自己对操作系统的理解，大概归纳如下：

​	**在操作系统看来两个逻辑上连续的sector未必在物理上就是连续的**。

​	因为读写都是物理地址映射出的基于虚拟地址，而现代操作系统基本都使用main memory为需要写的data做cache，使用append only的方法，能够尽可能的使得要写的内容在物理上连续，从而读的时候也是一个顺序读。



​	我们知道，**磁盘读写最慢的地方在于寻道**，根据kafka官网写的资料是，**寻道时间大概10ms**，寻道之后**磁头顺序读取信息的速度是很快的**。根据kafka官网的说法，6个7200转的磁盘组成raid5，顺序写的速度能达到（600MB/S），而随机读写速度仅为100kb/s，如下图所示，顺序读有时候比内存的随机读取还要快。而从stackoverflow上搜索得到的答案是，单块磁盘每30ms能写1MB数据，写100MB数据大概需要3秒钟。

<img src="https://deliveryimages.acm.org/10.1145/1570000/1563874/jacobs3.jpg" style="zoom:90%">









